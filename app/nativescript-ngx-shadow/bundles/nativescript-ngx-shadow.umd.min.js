!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("tns-core-modules/color"),require("tns-core-modules/ui/page/page"),require("tns-core-modules/platform"),require("@angular/core"),require("tns-core-modules/ui/core/weak-event-listener")):"function"==typeof define&&define.amd?define("nativescript-ngx-shadow",["exports","tns-core-modules/color","tns-core-modules/ui/page/page","tns-core-modules/platform","@angular/core","tns-core-modules/ui/core/weak-event-listener"],t):t(e["nativescript-ngx-shadow"]={},null,null,null,e.ng.core,null)}(this,function(e,s,E,n,t,a){"use strict";var w,c,R={RECTANGLE:"RECTANGLE",OVAL:"OVAL",RING:"RING",LINE:"LINE"};n.isAndroid&&(w=android.graphics.drawable.LayerDrawable.extend({}),c=android.graphics.drawable.GradientDrawable.extend({}));var i={};function S(e,t){var a="android.R$"+e;return i.hasOwnProperty(a)||(i[a]={"class":java.lang.Class.forName(a),fieldCache:{}}),i[a].fieldCache.hasOwnProperty(t)||(i[a].fieldCache[t]=+i[a]["class"].getField(t).get(null)),i[a].fieldCache[t]}var o=function(){function u(){}return u.apply=function(e,t){e.android&&21<=android.os.Build.VERSION.SDK_INT?u.applyOnAndroid(e,u.getDefaults(t)):e.ios&&u.applyOnIOS(e,u.getDefaults(t))},u.getDefaults=function(e){return Object.assign({},e,{shape:e.shape||u.DEFAULT_SHAPE,pressedElevation:e.pressedElevation||u.DEFAULT_PRESSED_ELEVATION,pressedTranslationZ:e.pressedTranslationZ||u.DEFAULT_PRESSED_ELEVATION,shadowColor:e.shadowColor||u.DEFAULT_SHADOW_COLOR,useShadowPath:e.useShadowPath===undefined||e.useShadowPath,rasterize:e.rasterize!==undefined&&e.rasterize})},u.isShadow=function(e){return e instanceof w||e instanceof c},u.applyOnAndroid=function(e,t){var a,i=e.android,o=!0,s=i.getBackground();if(s instanceof android.graphics.drawable.RippleDrawable){var n=s.getDrawable(0);n instanceof android.graphics.drawable.InsetDrawable?o=!1:u.isShadow(n)&&(s=n)}if(o){u.isShadow(s)&&(s=s instanceof w?s.getDrawable(1):null);var r=Array.create("float",8);t.cornerRadius===undefined?(r[0]=r[1]=E.Length.toDevicePixels(e.borderTopLeftRadius,0),r[2]=r[3]=E.Length.toDevicePixels(e.borderTopRightRadius,0),r[4]=r[5]=E.Length.toDevicePixels(e.borderBottomRightRadius,0),r[6]=r[7]=E.Length.toDevicePixels(e.borderBottomLeftRadius,0)):java.util.Arrays.fill(r,u.androidDipToPx(i,t.cornerRadius));var d=s&&s instanceof android.graphics.drawable.ColorDrawable&&s.getColor()?s.getColor():android.graphics.Color.parseColor(t.bgcolor||u.DEFAULT_BGCOLOR),h=void 0;if(t.shape!==R.RECTANGLE||t.bgcolor||!s)(a=new c).setShape(android.graphics.drawable.GradientDrawable[t.shape]),a.setCornerRadii(r),a.setColor(d),h=a;else{var l=new android.graphics.drawable.shapes.RoundRectShape(r,null,null);(a=new android.graphics.drawable.ShapeDrawable(l)).getPaint().setColor(d);var p=Array.create(android.graphics.drawable.Drawable,2);p[0]=a,p[1]=s,h=new w(p)}i.setBackgroundDrawable(h)}i.setElevation(u.androidDipToPx(i,t.elevation)),i.setTranslationZ(u.androidDipToPx(i,t.translationZ)),(i.getStateListAnimator()||t.forcePressAnimation)&&this.overrideDefaultAnimator(i,t)},u.overrideDefaultAnimator=function(e,t){var a=new android.animation.StateListAnimator,i=android.animation.ObjectAnimator,o=android.animation.AnimatorSet,s=S("integer","config_shortAnimTime"),n=e.getContext().getResources().getInteger(s)/2,r=this.androidDipToPx(e,t.pressedElevation),d=this.androidDipToPx(e,t.pressedTranslationZ),h=this.androidDipToPx(e,t.elevation),l=this.androidDipToPx(e,t.translationZ||0),p=new o,u=new o,E=new o;p.playTogether(java.util.Arrays.asList([i.ofFloat(e,"translationZ",[d]).setDuration(n),i.ofFloat(e,"elevation",[r]).setDuration(0)])),u.playTogether(java.util.Arrays.asList([i.ofFloat(e,"translationZ",[l]).setDuration(n),i.ofFloat(e,"elevation",[h]).setDuration(0)])),E.playTogether(java.util.Arrays.asList([i.ofFloat(e,"translationZ",[0]).setDuration(0),i.ofFloat(e,"elevation",[0]).setDuration(0)])),a.addState([S("attr","state_pressed"),S("attr","state_enabled")],p),a.addState([S("attr","state_enabled")],u),a.addState([],E),e.setStateListAnimator(a)},u.applyOnIOS=function(e,t){var a=e.ios,i=parseFloat((t.elevation-0).toFixed(2));a.layer.maskToBounds=!1,a.layer.shadowColor=new s.Color(t.shadowColor).ios.CGColor,a.layer.shadowOffset=t.shadowOffset?CGSizeMake(0,parseFloat(String(t.shadowOffset))):CGSizeMake(0,.54*i-.14),a.layer.shadowOpacity=t.shadowOpacity?parseFloat(String(t.shadowOpacity)):.006*i+.25,a.layer.shadowRadius=t.shadowRadius?parseFloat(String(t.shadowRadius)):.66*i-.5,a.layer.shouldRasterize=t.rasterize,a.layer.rasterizationScale=n.screen.mainScreen.scale;var o=null;t.useShadowPath&&(o=UIBezierPath.bezierPathWithRoundedRectCornerRadius(a.bounds,a.layer.shadowRadius).cgPath),a.layer.shadowPath=o},u.androidDipToPx=function(e,t){var a=e.getContext().getResources().getDisplayMetrics();return android.util.TypedValue.applyDimension(android.util.TypedValue.COMPLEX_UNIT_DIP,t,a)},u.DEFAULT_SHAPE=R.RECTANGLE,u.DEFAULT_BGCOLOR="#FFFFFF",u.DEFAULT_SHADOW_COLOR="#000000",u.DEFAULT_PRESSED_ELEVATION=2,u.DEFAULT_PRESSED_Z=4,u}(),r=function(){function e(e,t){var a=this;this.el=e,this.render=t,this.loaded=!1,this.initialized=!1,this.eventsBound=!1,this.monkeyPatch=function(e){a.previousNSFn.call(a.el.nativeElement,e),a.applyShadow()},n.isAndroid&&(this.originalNSFn=this.el.nativeElement._redrawNativeBackground)}return e.prototype.ngOnInit=function(){this.initialized||(this.initialized=!0,this.initializeCommonData(),n.isAndroid?this.initializeAndroidData():n.isIOS&&this.initializeIOSData(),this.shadow&&this.shadow.elevation&&(n.isAndroid?this.loadFromAndroidData(this.shadow):n.isIOS&&this.loadFromIOSData(this.shadow)),this.bindEvents())},e.prototype.ngOnDestroy=function(){this.initialized&&(this.unbindEvents(),this.initialized=!1)},e.prototype.bindEvents=function(){this.eventsBound||(a.addWeakEventListener(this.el.nativeElement,E.View.loadedEvent,this.onLoaded,this),a.addWeakEventListener(this.el.nativeElement,E.View.unloadedEvent,this.onUnloaded,this),this.eventsBound=!0,this.el.nativeElement.isLoaded&&this.onLoaded())},e.prototype.unbindEvents=function(){this.eventsBound&&(a.removeWeakEventListener(this.el.nativeElement,E.View.loadedEvent,this.onLoaded,this),a.removeWeakEventListener(this.el.nativeElement,E.View.unloadedEvent,this.onUnloaded,this),this.eventsBound=!1)},e.prototype.onLoaded=function(){this.loaded=!0,this.initialized||this.ngOnInit(),this.applyShadow(),n.isAndroid&&(this.previousNSFn=this.el.nativeElement._redrawNativeBackground,this.el.nativeElement._redrawNativeBackground=this.monkeyPatch)},e.prototype.addIosWrapper=function(){if(n.isIOS){var e=this.el.nativeElement;this.iosShadowRapper=this.render.createElement("StackLayout");var t=e.parentNode;this.render.insertBefore(t,this.iosShadowRapper,e),this.render.removeChild(t,e),this.render.appendChild(this.iosShadowRapper,e)}},e.prototype.onUnloaded=function(){this.loaded=!1,n.isAndroid&&(this.el.nativeElement._redrawNativeBackground=this.originalNSFn)},e.prototype.ngAfterViewInit=function(){this.addIosWrapper()},e.prototype.ngOnChanges=function(e){this.loaded&&e&&(e.hasOwnProperty("shadow")||e.hasOwnProperty("elevation")||e.hasOwnProperty("pressedElevation")||e.hasOwnProperty("shape")||e.hasOwnProperty("bgcolor")||e.hasOwnProperty("cornerRadius")||e.hasOwnProperty("pressedTranslationZ")||e.hasOwnProperty("forcePressAnimation")||e.hasOwnProperty("translationZ")||e.hasOwnProperty("maskToBounds")||e.hasOwnProperty("shadowColor")||e.hasOwnProperty("shadowOffset")||e.hasOwnProperty("shadowOpacity")||e.hasOwnProperty("shadowRadius")||e.hasOwnProperty("rasterize")||e.hasOwnProperty("useShadowMap"))&&(e.hasOwnProperty("shadow")&&!e.hasOwnProperty("elevation")&&"number"==typeof e.shadow.currentValue&&(this.elevation=e.shadow.currentValue),e.shadow&&e.shadow.currentValue.elevation&&(n.isAndroid?this.loadFromAndroidData(this.shadow):n.isIOS&&this.loadFromIOSData(this.shadow)),this.applyShadow())},e.prototype.applyShadow=function(){if(null!==this.shadow&&this.shadow!==undefined&&(""!==this.shadow||this.elevation)&&!(n.isAndroid&&android.os.Build.VERSION.SDK_INT<21)){var e=n.isIOS?this.iosShadowRapper:this.el.nativeElement;e&&o.apply(e,{elevation:this.elevation,pressedElevation:this.pressedElevation,shape:this.shape,bgcolor:this.bgcolor,cornerRadius:this.cornerRadius,translationZ:this.translationZ,pressedTranslationZ:this.pressedTranslationZ,forcePressAnimation:this.forcePressAnimation,maskToBounds:this.maskToBounds,shadowColor:this.shadowColor,shadowOffset:this.shadowOffset,shadowOpacity:this.shadowOpacity,shadowRadius:this.shadowRadius,rasterize:this.rasterize,useShadowPath:this.useShadowPath})}},e.prototype.initializeCommonData=function(){var e=typeof this.shadow;"string"!=e&&"number"!=e||this.elevation||(this.elevation=this.shadow?parseInt(this.shadow,10):2);var t=typeof this.elevation;"string"!=t&&"number"!=t||(this.elevation=this.elevation?parseInt(this.elevation,10):2)},e.prototype.initializeAndroidData=function(){"string"==typeof this.cornerRadius&&(this.cornerRadius=parseInt(this.cornerRadius,10)),"string"==typeof this.translationZ&&(this.translationZ=parseInt(this.translationZ,10))},e.prototype.initializeIOSData=function(){"string"==typeof this.shadowOffset&&(this.shadowOffset=parseFloat(this.shadowOffset)),"string"==typeof this.shadowOpacity&&(this.shadowOpacity=parseFloat(this.shadowOpacity)),"string"==typeof this.shadowRadius&&(this.shadowRadius=parseFloat(this.shadowRadius))},e.prototype.loadFromAndroidData=function(e){this.elevation=e.elevation||this.elevation,this.shape=e.shape||this.shape,this.bgcolor=e.bgcolor||this.bgcolor,this.cornerRadius=e.cornerRadius||this.cornerRadius,this.translationZ=e.translationZ||this.translationZ},e.prototype.loadFromIOSData=function(e){this.maskToBounds=e.maskToBounds||this.maskToBounds,this.shadowColor=e.shadowColor||this.shadowColor,this.shadowOffset=e.shadowOffset||this.shadowOffset,this.shadowOpacity=e.shadowOpacity||this.shadowOpacity,this.shadowRadius=e.shadowRadius||this.shadowRadius,this.rasterize=e.rasterize||this.rasterize,this.useShadowPath=e.useShadowPath||this.useShadowPath},e.decorators=[{type:t.Directive,args:[{selector:"[shadow]"}]}],e.ctorParameters=function(){return[{type:t.ElementRef},{type:t.Renderer2}]},e.propDecorators={shadow:[{type:t.Input}],elevation:[{type:t.Input}],pressedElevation:[{type:t.Input}],shape:[{type:t.Input}],bgcolor:[{type:t.Input}],cornerRadius:[{type:t.Input}],translationZ:[{type:t.Input}],pressedTranslationZ:[{type:t.Input}],forcePressAnimation:[{type:t.Input}],maskToBounds:[{type:t.Input}],shadowColor:[{type:t.Input}],shadowOffset:[{type:t.Input}],shadowOpacity:[{type:t.Input}],shadowRadius:[{type:t.Input}],useShadowPath:[{type:t.Input}],rasterize:[{type:t.Input}]},e}(),d=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{imports:[],declarations:[r],exports:[r],providers:[]}]}],e}(),h=function u(){},l={SWITCH:1,CARD_RESTING:2,RAISED_BUTTON_RESTING:2,SEARCH_BAR_RESTING:2,REFRESH_INDICADOR:3,SEARCH_BAR_SCROLLED:3,APPBAR:4,FAB_RESTING:6,SNACKBAR:6,BOTTOM_NAVIGATION_BAR:8,MENU:8,CARD_PICKED_UP:8,RAISED_BUTTON_PRESSED:8,SUBMENU_LEVEL1:9,SUBMENU_LEVEL2:10,SUBMENU_LEVEL3:11,SUBMENU_LEVEL4:12,SUBMENU_LEVEL5:13,FAB_PRESSED:12,NAV_DRAWER:16,RIGHT_DRAWER:16,MODAL_BOTTOM_SHEET:16,DIALOG:24,PICKER:24};l[l.SWITCH]="SWITCH",l[l.CARD_RESTING]="CARD_RESTING",l[l.RAISED_BUTTON_RESTING]="RAISED_BUTTON_RESTING",l[l.SEARCH_BAR_RESTING]="SEARCH_BAR_RESTING",l[l.REFRESH_INDICADOR]="REFRESH_INDICADOR",l[l.SEARCH_BAR_SCROLLED]="SEARCH_BAR_SCROLLED",l[l.APPBAR]="APPBAR",l[l.FAB_RESTING]="FAB_RESTING",l[l.SNACKBAR]="SNACKBAR",l[l.BOTTOM_NAVIGATION_BAR]="BOTTOM_NAVIGATION_BAR",l[l.MENU]="MENU",l[l.CARD_PICKED_UP]="CARD_PICKED_UP",l[l.RAISED_BUTTON_PRESSED]="RAISED_BUTTON_PRESSED",l[l.SUBMENU_LEVEL1]="SUBMENU_LEVEL1",l[l.SUBMENU_LEVEL2]="SUBMENU_LEVEL2",l[l.SUBMENU_LEVEL3]="SUBMENU_LEVEL3",l[l.SUBMENU_LEVEL4]="SUBMENU_LEVEL4",l[l.SUBMENU_LEVEL5]="SUBMENU_LEVEL5",l[l.FAB_PRESSED]="FAB_PRESSED",l[l.NAV_DRAWER]="NAV_DRAWER",l[l.RIGHT_DRAWER]="RIGHT_DRAWER",l[l.MODAL_BOTTOM_SHEET]="MODAL_BOTTOM_SHEET",l[l.DIALOG]="DIALOG",l[l.PICKER]="PICKER";var p=function A(){};e.NgShadowModule=d,e.AndroidData=h,e.Elevation=l,e.IOSData=p,e.Shadow=o,e.ShapeEnum=R,e.Éµa=r,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=nativescript-ngx-shadow.umd.min.js.map